<div class="auth-screen-outer d-flex align-items-center justify-content-center">
  <div class="auth-screen-inner w-100">
    <div class="auth-screen-header text-center">
      <div class="login-welcome-intro">
        <h5 class="mt-0">OTP Code</h5>
        <p class="mb-0">
          We send the OTP code via email to <br />
          <span>{{ form.get("email")?.value }}</span>
        </p>
      </div>
    </div>
    <div class="auth-screen-body">
      <form [formGroup]="form" class="auth-screen-form" appSubmitOnEnter>
        <div class="form-control-group">
          <label for="otpFormControl" class="form-label">OTP</label>
          <div class="otp-field-input position-relative">
            <app-input-number [formControl]="form.controls.otp" placeholder="OTP" id="otpFormControl" [maxLength]="4" [minLength]="4"></app-input-number>
          </div>
        </div>

        <div class="form-control-group">
          <label for="newPasswordFormControl" class="form-label">New Password</label>
          <div class="password-field-input position-relative">
            <app-input-password [formControl]="form.controls.password" id="newPasswordFormControl" placeholder="Enter new password"></app-input-password>
          </div>
          <div class="password-requirements mt-3">
            <small class="text-muted">Password must contain:</small>
            <ul class="list-unstyled mt-1 mb-0">
              @for (requirement of passwordRequirements; track $index) {
                <li class="d-flex align-items-center gap-1">
                  <i class="bi" [class.bi-check-circle-fill]="requirement.isValid" [class.bi-circle]="!requirement.isValid"></i>
                  <small [class.text-success]="requirement.isValid">{{ requirement.text }}</small>
                </li>
              }
            </ul>
          </div>
        </div>
        <div class="form-control-group mb-0">
          <label for="confirmNewPasswordFormControl" class="form-label">Confirm New Password</label>
          <div class="password-field-input position-relative">
            <app-input-password [formControl]="form.controls.passwordConfirm" id="confirmNewPasswordFormControl" placeholder="Confirm new password"></app-input-password>
          </div>
        </div>

        @if (reverseTimer.intervalId) {
          <p class="text-center pt-5 m-0">
            @if (!reverseTimer.isRunning()) {
              <span>Wait for 00:{{ reverseTimer.timerText() }}</span>
            }
            <a class="text-dark" (click)="!reverseTimer.isRunning() ? null : resendOTPCode()" [class.disabled]="!reverseTimer.isRunning()" [style.cursor]="reverseTimer.isRunning() ? 'pointer' : 'default'">
              <strong>
                <span class="loader-spinner">
                  Send Again
                  @if (sendAgainLoader.isLoading()) {
                    <span class="custom-spinner"></span>
                  }
                </span>
              </strong>
            </a>
          </p>
        }
        <div class="auth-screen-button-wrap pt-4 mt-2">
          <button class="primary-button border-0 btn btn-primary text-white text-center w-100" type="submit" [disabled]="form.invalid || !isPasswordValid" (click)="resetPassword()">
            <span class="loader-spinner">
              Submit
              @if (loader.isLoading()) {
                <span class="custom-spinner"></span>
              }
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
